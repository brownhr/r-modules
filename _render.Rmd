
```{r setup, include = FALSE}
library(tidyverse)
library(rmarkdown)
library(googledrive)

knitr::opts_chunk$set(echo = TRUE)

```


Hi, Maggie,

Run this script if you need to rebuild the rubrics. I've put them in both
`word_document` and `pdf_document` format. Just hit the "source" button.
Hopefully you wont need this often; it's mostly to have rubrics with embedded
plots that can be changed easily.   Make sure your rubrics are named like
_RM1_Rubric.Rmd, _RM2_Rubric.Rmd, etc. The leading underscore tells R studio
to ignore the file when building the website

``` {r}
rubric_list <- list.files(pattern = "^_.+_Rubric\\.Rmd", full.names = T)

out_dir <- "rubrics/files"

if(!dir.exists(out_dir)) dir.create(out_dir)

walk(
  rubric_list,
  function(input) {
  base <- basename(input)
  num <- str_extract(input, "\\d+")
  out_name <- paste0("R Module ", num, " Rubric")
    rmarkdown::render(
      input = input,
      output_dir = out_dir,
      output_format = c("bookdown::word_document2",
                        "bookdown::pdf_document2"),
      output_file = out_name
    )
  }
)
```

This function uploads the .docx files to Google Drive and this chunk needs to be run manually
``` {r, eval = FALSE}

# Loads the shared Google Drive with the googledrive package
gd_rmods <- drive_get(id = "1dFkBUBZY0JV6QUEMHV6mLBtZ0UPDMHjE")

# Gets child folders for each R Module
gd_sub <- drive_ls(gd_rmods)


# Lists the rubrics which are in .docx format
rubric_docx <- list.files(
  path = "rubrics/files",
  pattern = "^_.+\\.docx",
  full.names = TRUE)


# Uploads .docx rubrics to Google Drive
walk(rubric_docx, function(x) {
  base <- basename(x)
  num <- str_extract(x, "\\d+")
  name <- paste0("R Module ", num)
  gd_dir <- drive_get(id = gd_sub[gd_sub$name == name,]$id)
  drive_upload(x, path = gd_dir, name = paste0(name, " Rubric.docx"), overwrite = T)
})
```