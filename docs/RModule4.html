<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>R Markdown Reports and Survey Data</title>

<script src="site_libs/header-attrs-2.14/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<link rel="shortcut icon" href="aoa_r.svg" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">R Modules</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="Syllabus.html">
    <span class="fa fa-file-text"></span>
     
    Syllabus
  </a>
</li>
<li>
  <a href="about.html">
    <span class="fa fa-info"></span>
     
    About
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    R Modules
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="RModule1.html">R Module 1</a>
    </li>
    <li>
      <a href="RModule2.html">R Module 2</a>
    </li>
    <li>
      <a href="RModule3.html">R Module 3</a>
    </li>
    <li>
      <a href="RModule4.html">R Module 4</a>
    </li>
    <li>
      <a href="RModule5.html">R Module 5</a>
    </li>
    <li>
      <a href="RModule6.html">R Module 6</a>
    </li>
    <li>
      <a href="RModule7.html">R Module 7</a>
    </li>
    <li>
      <a href="RModule8.html">R Module 8</a>
    </li>
    <li>
      <a href="RModule9.html">R Module 9</a>
    </li>
    <li>
      <a href="RModule10.html">R Module 10</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">R Markdown Reports and Survey Data</h1>

</div>


<div id="generating-reports-using-r-markdown" class="section level1">
<h1>Generating Reports using R Markdown</h1>
<p>For this R Module, we’ll be analyzing some survey data; our data is a
survey of approximately 10,000 individuals who work in the tech
industry. The questionnaire was designed to ask respondents’ salaries in
$US, their job description, level of education, gender, and several
other attributes. We wish to examine the relationship between experience
level (years worked in a similar job), education, and salary – do people
with more experience and a higher level of education earn more money?
We’ll use R Markdown to run our analysis.</p>
<p>While generating reports using tools like Excel or Google Sheets is
perfectly fine, R is an extraordinarily powerful tool for exploring and
visualizing data, and is perfect for this sort of case. However, it’s
sometimes difficult to quickly generate a report or create a picture,
especially when we want to highlight a number of attributes
simultaneously.</p>
<p>This is where R Markdown comes in – R Markdown documents are
excellent at integrating both narrative text (paragraphs and “things
that you write”) and code (including tables, plots, and maps).</p>
<p>This R Module is intended to be an introduction into the field of R
Markdown; many formal publications, websites, and documents are written
almost entirely in R Markdown (including this website!) As such, there’s
no way this Module could tell you everything you need to know about R
Markdown, but I encourage you to take the time to learn how to use R
Markdown in your coding.</p>
<p>One of the main benefits of R Markdown is that your results are
highly reproducible; what you see in the document is the code that
actually generates your results. This makes troubleshooting easier for
you, and understanding easier for your readers.</p>
<div id="what-is-markdown" class="section level2">
<h2>What is Markdown?</h2>
<p>Markdown is a popular “markup language” designed to format plain-text
data, such as comments on many websites and documentation for code. In
text editors like Microsoft Word or Google Docs, called “What you see is
what you get (<em>WYSIWYG</em>)” editors, there are buttons for making
text italic, bold, underlined, etc., but it’s often difficult to
transfer that information from one editor to another; if you copy italic
text from a Word document into a program like Notepad, you lose all your
formatting.</p>
<p>Markdown, however is designed to be a “What you type is what you get
(<em>WYTIWYG</em>)” language. If you want to <em>italic</em> text, you
wrap your text with single *asterisks* or _underscores_. If you want
<strong>bold</strong> text, you **use** __two__, and you can
<strong><em>combine</em></strong> them with ***three***.</p>
<p>There are a ton of other formatting options available, such as lists,
links, etc. This module isn’t intended to teach Markdown, but rather a
variant called R Markdown. For more information regarding Markdown, you
can use sites like <a
href="https://about.gitlab.com/handbook/markdown-guide/">Handbook’s
Markdown Guide</a> or resources such as Stack Overflow.</p>
</div>
<div id="r-markdown" class="section level2">
<h2>R Markdown</h2>
<p>R Markdown is a variant of Markdown that is designed to work with R
code. In addition to all of the standard Markdown formatting rules, R
Markdown allows you to embed and run R code directly in your document,
in sections called <em>code chunks</em>. This lets you not only run your
code, but generate a document with text as well; perfect for writing up
labs! Once you get the hang of R Markdown documents, you won’t want to
write up reports in Word anymore. Rather than endlessly take screenshots
and paste into a document, you can embed your code in an R Markdown
document, and it’ll insert the plots and graphs that you generate
<em>directly</em>, like this:</p>
<pre><code>```{r}

x <- seq(-1, 1, length = 20)

y <- dnorm(x)

plot(x, y)

```</code></pre>
<p>Which gives you:</p>
<p><img src="RModule4_files/figure-html/code-example-1.png" width="50%" style="display: block; margin: auto;" /></p>
<p>Or, if you want to print a table, you can use:</p>
<pre><code>```{r}

head(mtcars)

```</code></pre>
<p>Which gives:</p>
<pre><code>##                    mpg cyl disp  hp drat    wt  qsec vs am gear carb
## Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
## Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
## Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
## Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
## Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</code></pre>
<p>When you’re ready to generate a document (whether a PDF, html, or
Word document), you <strong>knit</strong> your R Markdown, which runs
the included code, formats your text, and exports to a file format of
your choice.</p>
</div>
</div>
<div id="getting-started" class="section level1">
<h1>Getting Started</h1>
<p>Before we do anything with R Markdown, we need to do a bit of setup
to make sure that R Studio is good-to-go in a few ways.</p>
<p>Mainly, we’ll need to install a few R packages:</p>
<ul>
<li><code>rmarkdown</code>, <code>knitr</code>, <code>markdown</code>,
and <code>mime</code>: These allow R Studio to work with Markdown and R
Markdown</li>
<li><code>tinytex</code>: This package is a lightweight <a
href="https://yihui.org/tinytex/"><span
class="math inline">\(\LaTeX\)</span></a> distribution and is necessary
to kint to a .PDF.
<ul>
<li>After installing this package, run
<code>tinytex::install_tinytex()</code>. This step might take some
time.</li>
<li>If you have difficulties exporting to a .PDF, I’d recommend
outputting to Word or HTML.</li>
</ul></li>
</ul>
<p>To get things running, you can just run the following code:</p>
<pre class="r"><code>install.packages(&quot;rmarkdown&quot;, &quot;knitr&quot;, &quot;markdown&quot;, &quot;mime&quot;, &quot;tinytex&quot;)

tinytex::install_tinytex()</code></pre>
<p>Then, restart R Studio.</p>
<p>Let’s get started by creating a new R Project, as in previous R
Modules. Once you have that set up, we want to create a new R Markdown
document. Navigate to <code>File &gt; New File &gt; R Markdown</code>.
Give it a title, “R Module 4 Report”, enter your name, and select
<code>HTML</code> as the output format.</p>
<p><img src="img/R%20Module%204/New%20R%20Markdown.png" width="265" style="display: block; margin: auto;" /></p>
<p>You should see a file that looks something like this:</p>
<p><img src="img/R%20Module%204/R%20Markdown.png" width="386" style="display: block; margin: auto;" /></p>
<p>Go ahead and hit Save (<code>Ctrl-S</code>) and save your document.
When you create a new R Markdown document, it comes with some “example
text”, such as how to run code and insert “code chunks”. Feel free to
browse this example text, but delete everything outside the header (your
header is the text surrounded by three dashes, <code>---</code>).</p>
<div id="yaml-header" class="section level2">
<h2>YAML Header</h2>
<p>One of the most important parts of an R Markdown document is the
<em>YAML Header</em> – the beginning of the document surrounded by
<code>---</code>. YAML is a special kind of “data serialization
language”; basically, it’s a way of storing “options” in plain-text
format. Don’t worry too much about the details for now – this is an
introduction, after all – but just remember that most of your important
options like <code>title</code>, <code>date</code>, <code>output</code>,
etc. are stored here.</p>
</div>
<div id="code-chunks" class="section level2">
<h2>Code Chunks</h2>
<p>Code Chunks are the essential element of R Markdown documents; they
allow you to run R code within your document, giving you the ability to
embed tables, plots, figures, and maps directly in your document (no
more copy-pasting screenshots!).</p>
<p>These Code Chunks are surrounded by three backticks,
<code>```</code>, (it’s the key to the left of the <code>1</code> key on
most layouts). To insert a Chunk, you can also type
<code>Ctrl/Cmd-Alt-I</code>.</p>
<p>The <code>{r}</code> within the chunk signifies that the code we’re
writing is in the R language (likely, you won’t ever need to change that
for this course, but other options include <code>html</code>). Anything
in these curly braces is considered “knitr chunk options”, which control
how your code is run. For example, if you want to run code but not show
the code itself in your output document, you can specify
<code>echo = FALSE</code> in your chunk options (for this course, keep
<code>echo = TRUE</code> so we can troubleshoot your code!).</p>
<p>More info about chunk options can be found at Yihui Xie’s (developer
of knitr, rmarkdown, and many other incredible R packages) website at <a
href="https://yihui.org/knitr/options/"
class="uri">https://yihui.org/knitr/options/</a></p>
<hr />
</div>
<div id="writing-your-first-code-chunk" class="section level2">
<h2>Writing your first Code Chunk</h2>
<p>After removing everything but your YAML header, start by inserting a
new Chunk (<code>Ctrl-Alt-I</code>). Make sure there’s a couple lines
between your header and your Chunk.</p>
<p>Within your Chunk (the area between the sets of backticks should be
greyed-out) is where you can enter in R code. Generally, you should have
a separate Chunk for each “thing” you do; think of them like “paragraphs
of code”. Not only does this help keep your document tidy, it lets you
know exactly where potential problems in your code are.</p>
<p>In your first Chunk, we’ll load some data. Just like in R Scripts,
you have to load packages with the <code>library()</code> function. If
you get a message like</p>
<blockquote>
<p>Error in loadNamespace(x) : there is no package called
‘packagename’,</p>
</blockquote>
<p>it means you haven’t installed the package yet, and need to install
it with <code>install.packages("packagename")</code> (note the quotes
<em>here</em>, but not in <code>library()</code>!).</p>
<p>Let’s load our salary survey (<code>salary_survey.xlsx</code>) into
R. Our data comes in Excel format, but R has no issues working with this
kind of data; the <code>readxl</code> package was designed with this in
mind! We’ll load the <code>tidyverse</code> packages as well, so we can
manipulate our data with <code>dplyr</code> and <code>forcats</code>,
and visualize our data with <code>ggplot2</code>.</p>
<pre class="r"><code>library(tidyverse)
library(readxl)

survey &lt;- read_xlsx(path = &quot;data/salary_survey.xlsx&quot;)</code></pre>
<p>You should see three buttons, <img
src="img/R%20Module%204/chunkbuttons.png" />. The first is for your
Chunk options, and allows you to interactively set your options and name
your Chunk. The second runs all Code Chunks above the current one, and
the last runs the current Chunk itself.</p>
<p>Go ahead and run your Chunk. Oh, some helpful keyboard shortcuts in R
Markdown and R in general include (on Windows):</p>
<table>
<colgroup>
<col width="27%" />
<col width="72%" />
</colgroup>
<thead>
<tr class="header">
<th>Keys</th>
<th>Function</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>Ctrl Shift Enter</code></td>
<td>Runs the current Chunk (wherever your cursor is placed)</td>
</tr>
<tr class="even">
<td><code>Ctrl Alt R</code></td>
<td>Runs all Chunks, in order</td>
</tr>
<tr class="odd">
<td><code>Alt -</code></td>
<td>Enters the <code>&lt;-</code> operator</td>
</tr>
<tr class="even">
<td><code>Ctrl 1</code></td>
<td>Focuses the cursor on the Editor pane</td>
</tr>
<tr class="odd">
<td><code>Ctrl 2</code></td>
<td>Focuses the cursor on the Console pane</td>
</tr>
<tr class="even">
<td><code>Ctrl Shift M</code></td>
<td>Enters the <code>magrittr</code> <code>%&gt;%</code> Pipe
Operator</td>
</tr>
<tr class="odd">
<td><code>Ctrl Shift K</code></td>
<td>“Knits” the current R Markdown document</td>
</tr>
<tr class="even">
<td><code>Ctrl Shift C</code></td>
<td>‘Comments’ or ‘un-comments’ code with <code>#</code></td>
</tr>
</tbody>
</table>
<p>These are by no means all of the most useful shortcuts in R Studio,
but they’re the ones I use most often.</p>
<hr />
<p>For this R Module, you should focus on mainly on the document
structure and writing your document in R Markdown. Follow along with the
code – whenever you see code in this Module, put it in a Chunk. The
questions for this Module will be pretty simple; you’ll mostly be
describing the distributions and attributes of the data, but the idea is
to get you writing your answers in tandem with your Code Chunks, so you
can generate a document without having to copy and paste code and images
into something like a Word document.</p>
</div>
</div>
<div id="manipulating-data" class="section level1">
<h1>Manipulating Data</h1>
<p>Back to our code, let’s create another Code Chunk, in which we’ll
pull out some of the variables we want to work with. We’ll use
<code>dplyr</code> to select our variables of interest (stored in
columns), and the pipe operator <code>%&gt;%</code> (loaded with the
<code>tidyverse</code>), which takes whatever is on its left-hand side
and “pipes” it into a function on its right-hand side, like so:</p>
<p>Let’s select the columns and work with our data by creating a new
<code>object</code>, “<code>survey_sub</code>”. Using
<code>%&gt;%</code>, we’ll pipe our <code>survey</code> into the
<code>dplyr::select()</code> function. Again, you can type
<code>Ctrl-Shift-M</code> to insert a <code>%&gt;%</code>, and
<code>Alt-Minus'</code>to insert a <code>&lt;-</code>.</p>
<pre class="r"><code>survey_sub &lt;- survey %&gt;%
  select(`Survey Year`, Country, PrimaryDatabase, SalaryUSD, YearsWithThisDatabase, YearsWithThisTypeOfJob, Education)</code></pre>
<p>Now that we have a selection of the columns deemed most important,
let’s do some additional steps to clean up our data. Because the initial
survey was open-ended, some of the responses might not be correct or
make much sense. For example, under <code>YearsWithThisTypeOfJob</code>,
a few respondents answered with values like <code>2020</code> and
<code>1997</code>. It’s entirely likely that they meant that they had
been working in that job field <em>since</em> 2020 or 1997. In a
real-world analysis, you should clean the data up by calculating how
many years they have actually had, but in this module, we’ll simply
remove those columns.</p>
<p>We’ll also apply this process to a few other columns in the dataset,
as well as filtering by other columns to get a subset of the data that
we’re interested in. Our analysis intends to examine the distribution of
salary and education within the United states, so we’ll also filter by
respondents from within the U.S.</p>
<pre class="r"><code>survey_sub &lt;- survey_sub %&gt;%
  filter(
    YearsWithThisDatabase &lt;= 50,

    # Same for the following:
    YearsWithThisTypeOfJob &lt;= 50,

    # We&#39;re only interested in the U.S.
    Country == &quot;United States&quot;,

    # We want to filter out &quot;missing values&quot;
    Education != &quot;Not Asked&quot;,

    # Some respondents put in their hourly wage rather than their yearly salary;
    # it&#39;s doubtful that anyone only makes $13 USD per year working in this kind
    # of job!

    SalaryUSD &gt; 1000
  )</code></pre>
<p>Now, we should visually inspect our data. Let’s create a
visualization with <code>ggplot2</code>: a boxplot of the distribution
of salaries within each education level.</p>
<pre class="r"><code>survey_sub %&gt;%
  ggplot(aes(y = Education, x = SalaryUSD)) +
  geom_boxplot()</code></pre>
<p><img src="RModule4_files/figure-html/boxplots-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Our salaries don’t appear normally distributed, do they? When
exploring data, it’s often a good idea to <em>transform</em> your data
to help visualize the general distribution of the data. However, we
should always be careful when working with transformations when doing
any kind of <em>analysis</em>, as it could potentially skew our results
or lead us to conclusions that might not be entirely accurate. For now,
though, we’ll transform by taking the base-10 logarithm of our salary
variable:</p>
<pre class="r"><code>survey_sub &lt;- survey_sub %&gt;%
  mutate(
    SalaryLog10 = log10(SalaryUSD)
  )


# We&#39;ll pop this back into our boxplots...
survey_sub %&gt;%
  ggplot(aes(y = Education, x = SalaryLog10)) +
  geom_boxplot()</code></pre>
<p><img src="RModule4_files/figure-html/boxplots-log10-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Great! Although the data itself hasn’t changed, by applying a
transformation, we are able to see the shape and pattern of the
distribution of our variable more easily.</p>
<hr />
<p>Another consideration when working with data in R is the
<em>class</em> of the data we’re working with. Categorical variables in
R are best represented with the <code>factor</code> class; rather than a
<code>character</code>, which can represent any sort of text, a
<code>factor</code> is used when there is a known set of “choices” or
potential values. For example, if you had a dataset of movies, the name
of the movie would be best suited as a <code>character</code> variable,
while the <em>genre</em> of a movie might work better as a
<code>factor</code>.</p>
<p>We’ll convert (the R-technical term is “coerce”) our
<code>Education</code> variable to a <code>factor</code>, which allows
us to see more useful summary statistics about the number of occurrences
within each level of education.</p>
<pre class="r"><code>survey_sub$Education &lt;-
  factor(
    survey_sub$Education,

    # We set this argument to TRUE when the order of our factor matters, or if
    # we intend to compare the &quot;amount&quot; of education (a PhD is a greater
    # &quot;amount&quot; of education than a Bachelors, for example.)
    ordered = TRUE,

    # The `levels` argument requests a character vector of the different factor
    # levels in the dataset, and the order we want them to be in.
    levels = c(
      &quot;None (no degree completed)&quot;,
      &quot;Associates (2 years)&quot;,
      &quot;Bachelors (4 years)&quot;,
      &quot;Masters&quot;,
      &quot;Doctorate/PhD&quot;
    )
  )


summary(survey_sub)</code></pre>
<pre><code>##   Survey Year     Country          PrimaryDatabase      SalaryUSD      
##  Min.   :2017   Length:4494        Length:4494        Min.   :  11100  
##  1st Qu.:2017   Class :character   Class :character   1st Qu.:  85000  
##  Median :2018   Mode  :character   Mode  :character   Median : 102000  
##  Mean   :2018                                         Mean   : 107496  
##  3rd Qu.:2018                                         3rd Qu.: 122000  
##  Max.   :2019                                         Max.   :1450000  
##  YearsWithThisDatabase YearsWithThisTypeOfJob                      Education   
##  Min.   : 0.00         Min.   : 0.000         None (no degree completed): 671  
##  1st Qu.: 6.00         1st Qu.: 3.000         Associates (2 years)      : 500  
##  Median :10.00         Median : 5.000         Bachelors (4 years)       :2540  
##  Mean   :11.31         Mean   : 7.386         Masters                   : 759  
##  3rd Qu.:16.00         3rd Qu.:10.000         Doctorate/PhD             :  24  
##  Max.   :38.00         Max.   :40.000                                          
##   SalaryLog10   
##  Min.   :4.045  
##  1st Qu.:4.929  
##  Median :5.009  
##  Mean   :5.004  
##  3rd Qu.:5.086  
##  Max.   :6.161</code></pre>
<p>Our goal is to perform a Chi-Squared test, which only works on
categorical data. Our predictor variable, <code>Education</code>, is
categorical, but our response variable, <code>SalaryUSD</code> is
continuous. However, we’re not exactly worried yet about specific dollar
amounts, just a general “range” of salaries. A common way we describe
this is with figures (e.g., a “six-figure” salary). This just means the
“number of zeros” in one’s paycheck, and we pretty much have that data
already (a <span class="math inline">\(log_{10}\)</span>) transformation
is exactly what that represents). So, if we recode our
<code>SalaryLog10</code> column to be categorical (e.g., 4-figs, 5-figs,
etc.), we can perform a Chi-Squared test.</p>
<pre class="r"><code>factors &lt;-
  # The `cut()` function takes a character vector and &quot;cuts&quot; it into a factor,
  # by looking at values that fall within each break. Think of it as plotting a
  # histogram with a certain number of bins, and assigning each of those bins as
  # a factor level.
  cut(
    survey_sub$SalaryLog10,
    breaks = c(4, 5, 6, 7),
    labels = c(&quot;5 Figures&quot;, &quot;6 Figures&quot;, &quot;7 Figures&quot;)
  )

survey_sub$SalaryFigs &lt;- factors

summary(survey_sub)</code></pre>
<pre><code>##   Survey Year     Country          PrimaryDatabase      SalaryUSD      
##  Min.   :2017   Length:4494        Length:4494        Min.   :  11100  
##  1st Qu.:2017   Class :character   Class :character   1st Qu.:  85000  
##  Median :2018   Mode  :character   Mode  :character   Median : 102000  
##  Mean   :2018                                         Mean   : 107496  
##  3rd Qu.:2018                                         3rd Qu.: 122000  
##  Max.   :2019                                         Max.   :1450000  
##  YearsWithThisDatabase YearsWithThisTypeOfJob                      Education   
##  Min.   : 0.00         Min.   : 0.000         None (no degree completed): 671  
##  1st Qu.: 6.00         1st Qu.: 3.000         Associates (2 years)      : 500  
##  Median :10.00         Median : 5.000         Bachelors (4 years)       :2540  
##  Mean   :11.31         Mean   : 7.386         Masters                   : 759  
##  3rd Qu.:16.00         3rd Qu.:10.000         Doctorate/PhD             :  24  
##  Max.   :38.00         Max.   :40.000                                          
##   SalaryLog10        SalaryFigs  
##  Min.   :4.045   5 Figures:2182  
##  1st Qu.:4.929   6 Figures:2309  
##  Median :5.009   7 Figures:   3  
##  Mean   :5.004                   
##  3rd Qu.:5.086                   
##  Max.   :6.161</code></pre>
<p>Interesting! It looks like there are only 3 cases where an individual
reported a 7-figure salary. We probably want to filter out these cases,
as we won’t be able to make any significant statistical inference about
them (remember n = 30).</p>
<p>Let’s perform some final cleaning, and select out only the variables
we’re interested in:</p>
<pre class="r"><code>survey_clean &lt;- survey_sub %&gt;%
  # We&#39;re not interested in these columns, so we can exclude them with a &quot;-&quot;
  select(-PrimaryDatabase, -Country, SalaryLog10) %&gt;%
  # Likewise, we want to ignore the cases where the salary is 7 figures, so we set our filter criterion to the observations where SalaryFigs is not (!= represents &quot;is not&quot;) &quot;7 Figures&quot;.
  filter(SalaryFigs != &quot;7 Figures&quot;) %&gt;%
  # Even though we filtered out the cases of 7-figure salaries, the &quot;7 Figures&quot;
  # level still exists within our data. We use the `droplevels()` function to
  # remove unused factor levels. Nothing actually changes about our data itself,
  # but it helps keep our results tidy.
  droplevels()


summary(survey_clean)</code></pre>
<pre><code>##   Survey Year     SalaryUSD       YearsWithThisDatabase YearsWithThisTypeOfJob
##  Min.   :2017   Min.   :  11100   Min.   : 0.00         Min.   : 0.000        
##  1st Qu.:2017   1st Qu.:  85000   1st Qu.: 6.00         1st Qu.: 3.000        
##  Median :2018   Median : 102000   Median :10.00         Median : 5.000        
##  Mean   :2018   Mean   : 106616   Mean   :11.31         Mean   : 7.382        
##  3rd Qu.:2018   3rd Qu.: 122000   3rd Qu.:16.00         3rd Qu.:10.000        
##  Max.   :2019   Max.   :1000000   Max.   :38.00         Max.   :40.000        
##                       Education     SalaryLog10        SalaryFigs  
##  None (no degree completed): 671   Min.   :4.045   5 Figures:2182  
##  Associates (2 years)      : 500   1st Qu.:4.929   6 Figures:2309  
##  Bachelors (4 years)       :2538   Median :5.009                   
##  Masters                   : 758   Mean   :5.003                   
##  Doctorate/PhD             :  24   3rd Qu.:5.086                   
##                                    Max.   :6.000</code></pre>
<p>We can plot our remaining data, of which there are 2,570
observations:</p>
<pre class="r"><code>survey_clean %&gt;%
  ggplot(aes(x = YearsWithThisTypeOfJob, y = SalaryFigs, fill = SalaryFigs)) +
  geom_boxplot() +
  facet_grid(rows = vars(Education)) +
  labs(
    x = &quot;Years with this type of job&quot;,
    y = &quot;Salary Figures&quot;,
    title = &quot;Years Experience vs. Salary&quot;,
    fill = &quot;Figures&quot;
  )</code></pre>
<p><img src="RModule4_files/figure-html/boxplots-final-1.png" width="672" style="display: block; margin: auto;" /></p>
<hr />
</div>
<div id="finalizing-your-r-markdown" class="section level1">
<h1>Finalizing your R Markdown</h1>
<p>Once you have all of the code you need embedded in your code chunks
(remember, put each block of code in a separate chunk to keep things
tidy!), you’ll need to <em>knit</em> your R Markdown document to some
other format. Usually, you can export as either a <code>.html</code>,
<code>.pdf</code>, or <code>.docx</code> document; for compatibility,
we’ll export our document as a Word doc, <code>.docx</code>. Knitting to
a PDF can sometimes be tricky and requires additional software to be
installed – if you’re interested , it’s called <a
href="https://yihui.org/tinytex/">tinytex</a>, and is quite easy to set
up, but it’s a bit outside the scope of this Module.</p>
<p>Anyways, make sure that your header (the section between each
<code>---</code> at the top) looks about like:</p>
<pre><code>---
title: R Module 4
author: Your Name

output: word_document

---</code></pre>
<p>Whenever you’re ready to knit to a Word document, either click the
<code>Knit</code> icon (<img src="img/R%20Module%204/knit.png" />), or
enter <code>Ctrl-Shift-K</code>. This runs the R code in each code chunk
and embeds it into a document alongside whatever text you enter between
code chunks.</p>
<p>R Markdown is a very powerful tool for writing code alongside text –
this whole series of R Modules was written <em>entirely</em> in R
Markdown!</p>
<hr />
</div>
<div id="assignment" class="section level1">
<h1>Assignment</h1>
<p>For this assignment, you don’t have many questions to answer! Mostly,
the goal is to get you working with R Markdown, so the main thing to
submit will be the Word Document (or PDF, if you want) generated by R
Markdown.</p>
</div>

<p>&copy; 2022 Maggie Sugg & Harrison Brown. v.1.0.0</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
